From 4b7706fcf1c42b601e1180da9fff6afaeb85eacf Mon Sep 17 00:00:00 2001
From: phunkyfish <phunkyfish@gmail.com>
Date: Wed, 22 Apr 2020 09:40:56 +0100
Subject: [PATCH] [inputstream] support mime type by default for all
 inputstream addons

---
 .../include/kodi/addon-instance/Inputstream.h                 | 1 +
 xbmc/addons/kodi-addon-dev-kit/include/kodi/versions.h        | 4 ++--
 xbmc/cores/VideoPlayer/DVDInputStreams/InputStreamAddon.cpp   | 1 +
 3 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/Inputstream.h b/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/Inputstream.h
index caae30fd2018..478fd27f4826 100644
--- a/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/Inputstream.h
+++ b/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/Inputstream.h
@@ -72,6 +72,7 @@ extern "C"
   struct INPUTSTREAM
   {
     const char* m_strURL;
+    const char* m_mimeType;
 
     unsigned int m_nCountInfoValues;
     struct LISTITEMPROPERTY
diff --git a/xbmc/addons/kodi-addon-dev-kit/include/kodi/versions.h b/xbmc/addons/kodi-addon-dev-kit/include/kodi/versions.h
index 69515b151530..876f9577145d 100644
--- a/xbmc/addons/kodi-addon-dev-kit/include/kodi/versions.h
+++ b/xbmc/addons/kodi-addon-dev-kit/include/kodi/versions.h
@@ -85,8 +85,8 @@
 #define ADDON_INSTANCE_VERSION_IMAGEDECODER_XML_ID    "kodi.binary.instance.imagedecoder"
 #define ADDON_INSTANCE_VERSION_IMAGEDECODER_DEPENDS   "addon-instance/ImageDecoder.h"
 
-#define ADDON_INSTANCE_VERSION_INPUTSTREAM            "2.2.0"
-#define ADDON_INSTANCE_VERSION_INPUTSTREAM_MIN        "2.2.0"
+#define ADDON_INSTANCE_VERSION_INPUTSTREAM            "2.3.0"
+#define ADDON_INSTANCE_VERSION_INPUTSTREAM_MIN        "2.3.0"
 #define ADDON_INSTANCE_VERSION_INPUTSTREAM_XML_ID     "kodi.binary.instance.inputstream"
 #define ADDON_INSTANCE_VERSION_INPUTSTREAM_DEPENDS    "addon-instance/Inputstream.h"
 
diff --git a/xbmc/cores/VideoPlayer/DVDInputStreams/InputStreamAddon.cpp b/xbmc/cores/VideoPlayer/DVDInputStreams/InputStreamAddon.cpp
index 1c7f25aebd1c..b571bab7cf00 100644
--- a/xbmc/cores/VideoPlayer/DVDInputStreams/InputStreamAddon.cpp
+++ b/xbmc/cores/VideoPlayer/DVDInputStreams/InputStreamAddon.cpp
@@ -157,6 +157,7 @@ bool CInputStreamAddon::Open()
   }
 
   props.m_strURL = m_item.GetDynPath().c_str();
+  props.m_mimeType = m_item.GetMimeType().c_str();
 
   std::string libFolder = URIUtils::GetDirectory(Addon()->Path());
   std::string profileFolder = CSpecialProtocol::TranslatePath(Addon()->Profile());
