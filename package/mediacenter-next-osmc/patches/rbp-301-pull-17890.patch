From 9eec6f3fdde21894ac506a90203f4da89f901f5e Mon Sep 17 00:00:00 2001
From: wsnipex <wsnipex@a1.net>
Date: Mon, 18 May 2020 08:05:29 +0200
Subject: [PATCH 1/2] [depends/pillow] fix android library names

---
 tools/depends/target/pythonmodule-pil/Makefile | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/tools/depends/target/pythonmodule-pil/Makefile b/tools/depends/target/pythonmodule-pil/Makefile
index 07796ae8079c..ba89ccf64830 100644
--- a/tools/depends/target/pythonmodule-pil/Makefile
+++ b/tools/depends/target/pythonmodule-pil/Makefile
@@ -52,6 +52,10 @@ ifeq ($(OS),android)
 	mkdir -p $(PREFIX)/share/$(APP_NAME)/addons/script.module.pil/lib
 	cd $(PLATFORM); $(CROSSFLAGS) $(NATIVEPREFIX)/bin/python3 setup.py install --install-lib  $(PREFIX)/share/$(APP_NAME)/addons/script.module.pil
 	cd $(PREFIX)/share/$(APP_NAME)/addons/script.module.pil/lib && unzip -o ../Pillow-*.egg
+	cd $(PREFIX)/share/$(APP_NAME)/addons/script.module.pil/lib/PIL && \
+          sed -i -e 's/import sys/import os, sys /' \
+                 -e '/__file__/ s/_imaging/lib_imaging/g' \
+                 -e 's/pkg_resources.resource_filename(__name__,/os.path.join(os.environ["KODI_ANDROID_LIBS"], /'  _imaging*.py
 	cd $(PREFIX)/share/$(APP_NAME)/addons/script.module.pil && rm -rf Pillow-*.egg
 else ifeq ($(TARGET_PLATFORM),appletvos)
 	mkdir -p $(PILPATH)/lib

From 2333e03a5a76a652f4d9c933e748dd052638560b Mon Sep 17 00:00:00 2001
From: wsnipex <wsnipex@a1.net>
Date: Mon, 18 May 2020 08:52:35 +0200
Subject: [PATCH 2/2] [android] python: include profile module

---
 tools/depends/target/python3/modules.setup | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/tools/depends/target/python3/modules.setup b/tools/depends/target/python3/modules.setup
index f965baa4a1df..37ca064e2b26 100644
--- a/tools/depends/target/python3/modules.setup
+++ b/tools/depends/target/python3/modules.setup
@@ -339,6 +339,8 @@ binascii binascii.c
 # Fred Drake's interface to the Python parser
 parser parsermodule.c
 
+# profiling
+_lsprof _lsprof.c rotatingtree.c
 
 # Andrew Kuchling's zlib module.
 # This require zlib 1.1.3 (or later).
