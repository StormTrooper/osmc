From 505cc00a3cd75db6325d6d2744b611df411c16d9 Mon Sep 17 00:00:00 2001
From: Rechi <Rechi@users.noreply.github.com>
Date: Thu, 28 Jun 2018 20:00:00 +0200
Subject: [PATCH] FFmpeg: Bump to 4.0.1-Leia-Alpha-3

---
 .../windows/patches/0001-ffmpeg-detect-openssl.patch     |  2 +-
 .../patches/0002-ffmpeg-zlib-config-conflict.patch       |  2 +-
 .../windows/patches/0003-ffmpeg-fix-msvc.patch           | 16 ----------------
 tools/depends/target/ffmpeg/FFMPEG-VERSION               |  2 +-
 4 files changed, 3 insertions(+), 19 deletions(-)
 delete mode 100644 tools/buildsteps/windows/patches/0003-ffmpeg-fix-msvc.patch

diff --git a/tools/buildsteps/windows/patches/0001-ffmpeg-detect-openssl.patch b/tools/buildsteps/windows/patches/0001-ffmpeg-detect-openssl.patch
index a5d45799aef0..f5abbbfc9a7e 100644
--- a/tools/buildsteps/windows/patches/0001-ffmpeg-detect-openssl.patch
+++ b/tools/buildsteps/windows/patches/0001-ffmpeg-detect-openssl.patch
@@ -12,7 +12,7 @@ diff --git a/configure b/configure
 index a1818dc..1cf2a7c 100755
 --- a/configure
 +++ b/configure
-@@ -6124,6 +6124,7 @@
+@@ -6125,6 +6125,7 @@
                                 check_lib openssl openssl/ssl.h SSL_library_init -lssl -lcrypto ||
                                 check_lib openssl openssl/ssl.h SSL_library_init -lssl32 -leay32 ||
                                 check_lib openssl openssl/ssl.h SSL_library_init -lssl -lcrypto -lws2_32 -lgdi32 ||
diff --git a/tools/buildsteps/windows/patches/0002-ffmpeg-zlib-config-conflict.patch b/tools/buildsteps/windows/patches/0002-ffmpeg-zlib-config-conflict.patch
index 28d86ee73b19..0955cab1be4f 100644
--- a/tools/buildsteps/windows/patches/0002-ffmpeg-zlib-config-conflict.patch
+++ b/tools/buildsteps/windows/patches/0002-ffmpeg-zlib-config-conflict.patch
@@ -1,6 +1,6 @@
 --- a/configure
 +++ b/configure
-@@ -7143,6 +7143,9 @@
+@@ -7144,6 +7144,9 @@
                                       $CONFIG_EXTRA      \
                                       $ALL_COMPONENTS    \
  
diff --git a/tools/buildsteps/windows/patches/0003-ffmpeg-fix-msvc.patch b/tools/buildsteps/windows/patches/0003-ffmpeg-fix-msvc.patch
deleted file mode 100644
index eb816ce29aa0..000000000000
--- a/tools/buildsteps/windows/patches/0003-ffmpeg-fix-msvc.patch
+++ /dev/null
@@ -1,16 +0,0 @@
-diff --git a/configure b/configure
-index 4c99a80..d036bc0 100644
---- a/configure
-+++ b/configure
-@@ -4411,7 +4411,7 @@ probe_cc(){
-         _flags_filter=msvc_flags
-         _ld_lib='lib%.a'
-         _ld_path='-libpath:'
--    elif $_cc -nologo- 2>&1 | grep -q Microsoft || $_cc -v 2>&1 | grep -q clang && $_cc -? > /dev/null 2>&1; then
-+    elif $_cc -nologo- 2>&1 | grep -q Microsoft; then
-         _type=msvc
-         _ident=$($_cc 2>&1 | head -n1 | tr -d '\r')
-         _DEPCMD='$(DEP$(1)) $(DEP$(1)FLAGS) $($(1)DEP_FLAGS) $< 2>&1 | awk '\''/including/ { sub(/^.*file: */, ""); gsub(/\\/, "/"); if (!match($$0, / /)) print "$@:", $$0 }'\'' > $(@:.o=.d)'
--- 
-2.14.1.windows.1
-
diff --git a/tools/depends/target/ffmpeg/FFMPEG-VERSION b/tools/depends/target/ffmpeg/FFMPEG-VERSION
index d29ea884d7d8..d48364236273 100644
--- a/tools/depends/target/ffmpeg/FFMPEG-VERSION
+++ b/tools/depends/target/ffmpeg/FFMPEG-VERSION
@@ -1,4 +1,4 @@
 LIBNAME=ffmpeg
 BASE_URL=https://github.com/xbmc/FFmpeg
-VERSION=4.0-Leia-Alpha-1
+VERSION=4.0.1-Leia-Alpha3-1
 ARCHIVE=$(LIBNAME)-$(VERSION).tar.gz
