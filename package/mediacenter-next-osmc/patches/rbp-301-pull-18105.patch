From 0fda0c2ffef8381e64f083ef45bc3ac6e94b9887 Mon Sep 17 00:00:00 2001
From: ronie <ronie@kodi.tv>
Date: Sat, 27 Jun 2020 17:04:34 +0200
Subject: [PATCH] [Estuary] fix touch back button

---
 addons/skin.estuary/xml/Includes.xml  | 43 +++++++++++++++++++++++++++
 addons/skin.estuary/xml/MusicOSD.xml  | 21 +------------
 addons/skin.estuary/xml/SlideShow.xml | 20 +------------
 addons/skin.estuary/xml/VideoOSD.xml  | 21 +------------
 4 files changed, 46 insertions(+), 59 deletions(-)

diff --git a/addons/skin.estuary/xml/Includes.xml b/addons/skin.estuary/xml/Includes.xml
index 50d18775dba8..9b58087a5ed6 100644
--- a/addons/skin.estuary/xml/Includes.xml
+++ b/addons/skin.estuary/xml/Includes.xml
@@ -1356,6 +1356,49 @@
 			<textureradiooffnofocus colordiffuse="grey">icons/back.png</textureradiooffnofocus>
 		</control>
 	</include>
+	<include name="TouchBackOSDButton">
+		<control type="radiobutton" id="799">
+			<left>-10</left>
+			<top>-10</top>
+			<width>120</width>
+			<height>120</height>
+			<align>center</align>
+			<aligny>center</aligny>
+			<onclick>Dialog.Close(all,true)</onclick>
+			<onclick>Action(FullScreen)</onclick>
+			<texturefocus colordiffuse="button_focus">buttons/roundbutton-fo.png</texturefocus>
+			<texturenofocus />
+			<radioposx>30</radioposx>
+			<radiowidth>60</radiowidth>
+			<radioheight>60</radioheight>
+			<textureradioonfocus>icons/back.png</textureradioonfocus>
+			<textureradioonnofocus colordiffuse="grey">icons/back.png</textureradioonnofocus>
+			<textureradioofffocus>icons/back.png</textureradioofffocus>
+			<textureradiooffnofocus colordiffuse="grey">icons/back.png</textureradiooffnofocus>
+			<include>Animation_TopSlide</include>
+		</control>
+	</include>
+	<include name="TouchBackSlideshowButton">
+		<control type="radiobutton" id="13">
+			<left>-10</left>
+			<top>-10</top>
+			<width>120</width>
+			<height>120</height>
+			<align>center</align>
+			<aligny>center</aligny>
+			<onfocus>Action(Back)</onfocus>
+			<texturefocus colordiffuse="button_focus">buttons/roundbutton-fo.png</texturefocus>
+			<texturenofocus />
+			<radioposx>30</radioposx>
+			<radiowidth>60</radiowidth>
+			<radioheight>60</radioheight>
+			<textureradioonfocus>icons/back.png</textureradioonfocus>
+			<textureradioonnofocus colordiffuse="grey">icons/back.png</textureradioonnofocus>
+			<textureradioofffocus>icons/back.png</textureradioofffocus>
+			<textureradiooffnofocus colordiffuse="grey">icons/back.png</textureradiooffnofocus>
+			<visible>!Window.IsVisible(PictureInfo)</visible>
+		</control>
+	</include>
 	<include name="SettingsPanel">
 		<itemlayout height="260" width="400">
 			<control type="image">
diff --git a/addons/skin.estuary/xml/MusicOSD.xml b/addons/skin.estuary/xml/MusicOSD.xml
index 844e47bb4899..af48132b0241 100644
--- a/addons/skin.estuary/xml/MusicOSD.xml
+++ b/addons/skin.estuary/xml/MusicOSD.xml
@@ -14,26 +14,7 @@
 			<texturenofocus />
 			<onclick>Action(close)</onclick>
 		</control>
-		<control type="radiobutton" id="799">
-			<left>-10</left>
-			<top>-10</top>
-			<width>120</width>
-			<height>120</height>
-			<align>center</align>
-			<aligny>center</aligny>
-			<onclick>Dialog.Close(all,true)</onclick>
-			<onclick>Action(FullScreen)</onclick>
-			<texturefocus colordiffuse="button_focus">buttons/roundbutton-fo.png</texturefocus>
-			<texturenofocus />
-			<radioposx>30</radioposx>
-			<radiowidth>60</radiowidth>
-			<radioheight>60</radioheight>
-			<textureradioonfocus>icons/back.png</textureradioonfocus>
-			<textureradioonnofocus colordiffuse="grey">icons/back.png</textureradioonnofocus>
-			<textureradioofffocus>icons/back.png</textureradioofffocus>
-			<textureradiooffnofocus colordiffuse="grey">icons/back.png</textureradiooffnofocus>
-			<include>Animation_TopSlide</include>
-		</control>
+		<include condition="Skin.HasSetting(touchmode)">TouchBackOSDButton</include>
 		<control type="group" id="200">
 			<include>Animation_BottomSlide</include>
 			<bottom>0</bottom>
diff --git a/addons/skin.estuary/xml/SlideShow.xml b/addons/skin.estuary/xml/SlideShow.xml
index 97a5deb778e3..d002709d5cb8 100644
--- a/addons/skin.estuary/xml/SlideShow.xml
+++ b/addons/skin.estuary/xml/SlideShow.xml
@@ -1,25 +1,7 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <window>
 	<controls>
-		<control type="radiobutton" id="13">
-			<left>-10</left>
-			<top>-10</top>
-			<width>120</width>
-			<height>120</height>
-			<align>center</align>
-			<aligny>center</aligny>
-			<onfocus>Action(Back)</onfocus>
-			<texturefocus colordiffuse="button_focus">buttons/roundbutton-fo.png</texturefocus>
-			<texturenofocus />
-			<radioposx>30</radioposx>
-			<radiowidth>60</radiowidth>
-			<radioheight>60</radioheight>
-			<textureradioonfocus>icons/back.png</textureradioonfocus>
-			<textureradioonnofocus colordiffuse="grey">icons/back.png</textureradioonnofocus>
-			<textureradioofffocus>icons/back.png</textureradioofffocus>
-			<textureradiooffnofocus colordiffuse="grey">icons/back.png</textureradiooffnofocus>
-			<visible>!Window.IsVisible(PictureInfo)</visible>
-		</control>
+		<include condition="Skin.HasSetting(touchmode)">TouchBackSlideshowButton</include>
 		<control type="image">
 			<centerleft>50%</centerleft>
 			<centertop>50%</centertop>
diff --git a/addons/skin.estuary/xml/VideoOSD.xml b/addons/skin.estuary/xml/VideoOSD.xml
index f8200b19f1bc..4b60003a79cc 100644
--- a/addons/skin.estuary/xml/VideoOSD.xml
+++ b/addons/skin.estuary/xml/VideoOSD.xml
@@ -14,26 +14,7 @@
 			<texturenofocus />
 			<onclick>Action(close)</onclick>
 		</control>
-		<control type="radiobutton" id="799">
-			<left>-10</left>
-			<top>-10</top>
-			<width>120</width>
-			<height>120</height>
-			<align>center</align>
-			<aligny>center</aligny>
-			<onclick>Dialog.Close(all,true)</onclick>
-			<onclick>Action(FullScreen)</onclick>
-			<texturefocus colordiffuse="button_focus">buttons/roundbutton-fo.png</texturefocus>
-			<texturenofocus />
-			<radioposx>30</radioposx>
-			<radiowidth>60</radiowidth>
-			<radioheight>60</radioheight>
-			<textureradioonfocus>icons/back.png</textureradioonfocus>
-			<textureradioonnofocus colordiffuse="grey">icons/back.png</textureradioonnofocus>
-			<textureradioofffocus>icons/back.png</textureradioofffocus>
-			<textureradiooffnofocus colordiffuse="grey">icons/back.png</textureradiooffnofocus>
-			<include>Animation_TopSlide</include>
-		</control>
+		<include condition="Skin.HasSetting(touchmode)">TouchBackOSDButton</include>
 		<control type="group">
 			<include>Animation_BottomSlide</include>
 			<bottom>0</bottom>
