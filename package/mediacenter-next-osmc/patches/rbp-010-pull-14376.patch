From 4e8bdda9d0aef6f75937695f6c8143b7cd2b9463 Mon Sep 17 00:00:00 2001
From: Mario Franco <mario@vivasuperstars.com>
Date: Wed, 29 Aug 2018 22:51:09 +0100
Subject: [PATCH] Show EPG image on the Dialog Seek Bar during video playback
 and MyPVRChannels screen

---
 addons/skin.estuary/xml/DialogSeekBar.xml | 22 +++++++++++++++++++++-
 addons/skin.estuary/xml/Includes_PVR.xml  |  2 +-
 addons/skin.estuary/xml/Variables.xml     |  4 ++++
 3 files changed, 26 insertions(+), 2 deletions(-)

diff --git a/addons/skin.estuary/xml/DialogSeekBar.xml b/addons/skin.estuary/xml/DialogSeekBar.xml
index b4b4d6de91cd..e1169701a92b 100644
--- a/addons/skin.estuary/xml/DialogSeekBar.xml
+++ b/addons/skin.estuary/xml/DialogSeekBar.xml
@@ -255,12 +255,32 @@
 				<label fallback="19055">$INFO[VideoPlayer.Plot]</label>
 				<align>justify</align>
 				<autoscroll delay="5000" repeat="7500" time="5000"></autoscroll>
+				<visible>String.IsEmpty(PVR.EpgEventIcon)</visible>
+			</control>
+			<control type="textbox">
+				<left>260</left>
+				<top>10</top>
+				<right>260</right>
+				<height>160</height>
+				<label fallback="19055">$INFO[VideoPlayer.Plot]</label>
+				<align>justify</align>
+				<autoscroll delay="5000" repeat="7500" time="5000"></autoscroll>
+				<visible>!String.IsEmpty(PVR.EpgEventIcon)</visible>
+			</control>
+			<control type="image">
+				<right>30</right>
+				<top>20</top>
+				<width>200</width>
+				<height>200</height>
+				<aspectratio aligny="center">keep</aspectratio>
+				<texture fallback="DefaultTVShows.png">$INFO[PVR.EpgEventIcon]</texture>
+				<visible>!String.IsEmpty(PVR.EpgEventIcon)</visible>
 			</control>
 			<control type="label">
 				<left>260</left>
 				<top>180</top>
 				<height>25</height>
-        <label>[COLOR grey]$LOCALIZE[19031]:[/COLOR] $INFO[VideoPlayer.NextStartTime] - $INFO[VideoPlayer.NextEndTime]: $INFO[VideoPlayer.NextTitle]</label>
+				<label>[COLOR grey]$LOCALIZE[19031]:[/COLOR] $INFO[VideoPlayer.NextStartTime] - $INFO[VideoPlayer.NextEndTime]: $INFO[VideoPlayer.NextTitle]</label>
 				<visible>VideoPlayer.HasEpg</visible>
 			</control>
 		</control>
diff --git a/addons/skin.estuary/xml/Includes_PVR.xml b/addons/skin.estuary/xml/Includes_PVR.xml
index 8ec061bee38b..c6b869ebc4b2 100644
--- a/addons/skin.estuary/xml/Includes_PVR.xml
+++ b/addons/skin.estuary/xml/Includes_PVR.xml
@@ -197,7 +197,7 @@
 				<width>200</width>
 				<height>200</height>
 				<aspectratio align="center" aligny="top">keep</aspectratio>
-				<texture>$INFO[Listitem.Icon]</texture>
+				<texture fallback="DefaultTVShows.png">$VAR[ChannelListEPGIconVar]</texture>
 				<fadetime>200</fadetime>
 			</control>
 			<control type="group">
diff --git a/addons/skin.estuary/xml/Variables.xml b/addons/skin.estuary/xml/Variables.xml
index 24482c6f9ae4..dd50327d6d87 100644
--- a/addons/skin.estuary/xml/Variables.xml
+++ b/addons/skin.estuary/xml/Variables.xml
@@ -438,4 +438,8 @@
 		<value condition="!System.IsMaster">$LOCALIZE[20045]</value>
 		<value>$LOCALIZE[20046]</value>
 	</variable>
+	<variable name="ChannelListEPGIconVar">
+		<value condition="!String.IsEmpty(Listitem.EpgEventIcon)">$INFO[ListItem.EpgEventIcon]</value>
+		<value>$INFO[ListItem.Icon]</value>
+	</variable>
 </includes>
