From bcc31928d3cfd9dcb7cc9f36c6037227d12e6b2e Mon Sep 17 00:00:00 2001
From: Lukas Rusak <lorusak@gmail.com>
Date: Sun, 19 May 2019 13:17:03 -0700
Subject: [PATCH 1/2] [linux] glibc recommends only using _FILE_OFFSET_BITS for
 new programs

---
 cmake/scripts/linux/ArchSetup.cmake | 2 +-
 xbmc/platform/linux/PlatformDefs.h  | 7 -------
 2 files changed, 1 insertion(+), 8 deletions(-)

diff --git a/cmake/scripts/linux/ArchSetup.cmake b/cmake/scripts/linux/ArchSetup.cmake
index 602ef3d031dc..66d1dd6bc5f6 100644
--- a/cmake/scripts/linux/ArchSetup.cmake
+++ b/cmake/scripts/linux/ArchSetup.cmake
@@ -1,7 +1,7 @@
 # we always want to use GNU features if available, so set _GNU_SOURCE
 set(ARCH_DEFINES -D_LINUX -DTARGET_POSIX -DTARGET_LINUX -D_GNU_SOURCE)
 set(SYSTEM_DEFINES -D__STDC_CONSTANT_MACROS -D_FILE_DEFINED
-                   -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64)
+                   -D_FILE_OFFSET_BITS=64)
 set(PLATFORM_DIR platform/linux)
 set(CMAKE_SYSTEM_NAME Linux)
 if(WITH_ARCH)
diff --git a/xbmc/platform/linux/PlatformDefs.h b/xbmc/platform/linux/PlatformDefs.h
index 6a47b3ada6d5..81326b089a03 100644
--- a/xbmc/platform/linux/PlatformDefs.h
+++ b/xbmc/platform/linux/PlatformDefs.h
@@ -8,13 +8,6 @@
 
 #pragma once
 
-#ifndef _LARGEFILE64_SOURCE
-#define _LARGEFILE64_SOURCE
-#endif
-
-#undef _FILE_OFFSET_BITS
-#define _FILE_OFFSET_BITS 64
-
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <fcntl.h>

From 980e0dad8eb23888258e48bf57b91e8dea3c54a3 Mon Sep 17 00:00:00 2001
From: Lukas Rusak <lorusak@gmail.com>
Date: Sun, 19 May 2019 13:33:12 -0700
Subject: [PATCH 2/2] [linux] remove unneeded define _FILE_DEFINED

---
 cmake/scripts/linux/ArchSetup.cmake | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/cmake/scripts/linux/ArchSetup.cmake b/cmake/scripts/linux/ArchSetup.cmake
index 66d1dd6bc5f6..30da42d7c448 100644
--- a/cmake/scripts/linux/ArchSetup.cmake
+++ b/cmake/scripts/linux/ArchSetup.cmake
@@ -1,7 +1,6 @@
 # we always want to use GNU features if available, so set _GNU_SOURCE
 set(ARCH_DEFINES -D_LINUX -DTARGET_POSIX -DTARGET_LINUX -D_GNU_SOURCE)
-set(SYSTEM_DEFINES -D__STDC_CONSTANT_MACROS -D_FILE_DEFINED
-                   -D_FILE_OFFSET_BITS=64)
+set(SYSTEM_DEFINES -D__STDC_CONSTANT_MACROS -D_FILE_OFFSET_BITS=64)
 set(PLATFORM_DIR platform/linux)
 set(CMAKE_SYSTEM_NAME Linux)
 if(WITH_ARCH)
