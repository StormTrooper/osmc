From ad00eb578b60fc439023db71dc7c30e3461b029b Mon Sep 17 00:00:00 2001
From: Lukas Rusak <lorusak@gmail.com>
Date: Sun, 22 Mar 2020 08:19:53 -0700
Subject: [PATCH] [RetroPlayer] CRPRendererDMA: use GL_TEXTURE_2D as OES
 EXTERNAL should be used for YUV formats

---
 xbmc/cores/RetroPlayer/buffers/RenderBufferDMA.h               | 2 +-
 .../RetroPlayer/rendering/VideoRenderers/RPRendererDMA.cpp     | 3 +--
 2 files changed, 2 insertions(+), 3 deletions(-)

diff --git a/xbmc/cores/RetroPlayer/buffers/RenderBufferDMA.h b/xbmc/cores/RetroPlayer/buffers/RenderBufferDMA.h
index a08035e0217e..a45ba43b4d1c 100644
--- a/xbmc/cores/RetroPlayer/buffers/RenderBufferDMA.h
+++ b/xbmc/cores/RetroPlayer/buffers/RenderBufferDMA.h
@@ -52,7 +52,7 @@ namespace RETRO
     CRenderContext &m_context;
     const int m_fourcc = 0;
 
-    const GLenum m_textureTarget = GL_TEXTURE_EXTERNAL_OES;
+    const GLenum m_textureTarget = GL_TEXTURE_2D;
     GLuint m_textureId = 0;
 
   private:
diff --git a/xbmc/cores/RetroPlayer/rendering/VideoRenderers/RPRendererDMA.cpp b/xbmc/cores/RetroPlayer/rendering/VideoRenderers/RPRendererDMA.cpp
index c335b2986f6e..1982f9855de9 100644
--- a/xbmc/cores/RetroPlayer/rendering/VideoRenderers/RPRendererDMA.cpp
+++ b/xbmc/cores/RetroPlayer/rendering/VideoRenderers/RPRendererDMA.cpp
@@ -42,7 +42,6 @@ CRPRendererDMA::CRPRendererDMA(const CRenderSettings& renderSettings,
                                std::shared_ptr<IRenderBufferPool> bufferPool)
   : CRPRendererOpenGLES(renderSettings, context, std::move(bufferPool))
 {
-  m_textureTarget = GL_TEXTURE_EXTERNAL_OES;
 }
 
 void CRPRendererDMA::Render(uint8_t alpha)
@@ -69,7 +68,7 @@ void CRPRendererDMA::Render(uint8_t alpha)
   glTexParameteri(m_textureTarget, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
   glTexParameteri(m_textureTarget, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
 
-  m_context.EnableGUIShader(GL_SHADER_METHOD::TEXTURE_RGBA_OES);
+  m_context.EnableGUIShader(GL_SHADER_METHOD::TEXTURE_NOALPHA);
 
   GLubyte colour[4];
   GLubyte idx[4] = {0, 1, 3, 2}; // Determines order of triangle strip
