From 698754fa78d390efc3e1446d11c80cc7debd5888 Mon Sep 17 00:00:00 2001
From: Anton Fedchin <anightik@gmail.com>
Date: Thu, 28 Jun 2018 09:41:48 +0300
Subject: [PATCH] filesystem: SpecialProtocol - fix possible endless recursion
 in URIUtils::IsRemote if SpecialProtocol returns the same path.

---
 xbmc/filesystem/SpecialProtocol.cpp | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/xbmc/filesystem/SpecialProtocol.cpp b/xbmc/filesystem/SpecialProtocol.cpp
index d76d7ad961a8..aa03b5c79dc2 100644
--- a/xbmc/filesystem/SpecialProtocol.cpp
+++ b/xbmc/filesystem/SpecialProtocol.cpp
@@ -179,9 +179,8 @@ std::string CSpecialProtocol::TranslatePath(const CURL &url)
   {
     auto winSystem = CServiceBroker::GetWinSystem();
     // windowing may not have been initialized yet
-    if (!winSystem)
-      return url.Get();
-    translatedPath = URIUtils::AddFileToFolder(CServiceBroker::GetWinSystem()->GetGfxContext().GetMediaDir(), FileName);
+    if (winSystem)
+      translatedPath = URIUtils::AddFileToFolder(winSystem->GetGfxContext().GetMediaDir(), FileName);
   }
   // from here on, we have our "real" special paths
   else if (RootDir == "xbmc" ||
