From fd385fc961f06b1ffa5852750b447fca2f99a161 Mon Sep 17 00:00:00 2001
From: djp952 <djp952@gmail.com>
Date: Mon, 22 Jun 2020 17:32:47 -0400
Subject: [PATCH] [PVR] APIv7 crash when EPG_TAG structure contains null
 pointers

---
 .../include/kodi/addon-instance/pvr/EPG.h     | 26 +++++++++----------
 1 file changed, 13 insertions(+), 13 deletions(-)

diff --git a/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/pvr/EPG.h b/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/pvr/EPG.h
index cdfb304a8e2b..a316e1367112 100644
--- a/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/pvr/EPG.h
+++ b/xbmc/addons/kodi-addon-dev-kit/include/kodi/addon-instance/pvr/EPG.h
@@ -434,19 +434,19 @@ class PVREPGTag : public CStructHdl<PVREPGTag, EPG_TAG>
 
   void SetData(const EPG_TAG* tag)
   {
-    m_title = tag->strTitle;
-    m_plotOutline = tag->strPlotOutline;
-    m_plot = tag->strPlot;
-    m_originalTitle = tag->strOriginalTitle;
-    m_cast = tag->strCast;
-    m_director = tag->strDirector;
-    m_writer = tag->strWriter;
-    m_IMDBNumber = tag->strIMDBNumber;
-    m_iconPath = tag->strIconPath;
-    m_genreDescription = tag->strGenreDescription;
-    m_episodeName = tag->strEpisodeName;
-    m_seriesLink = tag->strSeriesLink;
-    m_firstAired = tag->strFirstAired;
+    m_title = tag->strTitle == nullptr ? "" : tag->strTitle;
+    m_plotOutline = tag->strPlotOutline == nullptr ? "" : tag->strPlotOutline;
+    m_plot = tag->strPlot == nullptr ? "" : tag->strPlot;
+    m_originalTitle = tag->strOriginalTitle == nullptr ? "" : tag->strOriginalTitle;
+    m_cast = tag->strCast == nullptr ? "" : tag->strCast;
+    m_director = tag->strDirector == nullptr ? "" : tag->strDirector;
+    m_writer = tag->strWriter == nullptr ? "" : tag->strWriter;
+    m_IMDBNumber = tag->strIMDBNumber == nullptr ? "" : tag->strIMDBNumber;
+    m_iconPath = tag->strIconPath == nullptr ? "" : tag->strIconPath;
+    m_genreDescription = tag->strGenreDescription == nullptr ? "" : tag->strGenreDescription;
+    m_episodeName = tag->strEpisodeName == nullptr ? "" : tag->strEpisodeName;
+    m_seriesLink = tag->strSeriesLink == nullptr ? "" : tag->strSeriesLink;
+    m_firstAired = tag->strFirstAired == nullptr ? "" : tag->strFirstAired;
   }
 };
 ///@}
