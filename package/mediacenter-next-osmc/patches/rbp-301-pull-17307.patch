From 01a018e1d7737f6547e93f13a769625a665a83c6 Mon Sep 17 00:00:00 2001
From: Alwin Esch <alwin.esch@web.de>
Date: Sat, 1 Feb 2020 21:57:54 +0100
Subject: [PATCH 1/4] [cmake][addons] remove kodi platform from depends

Allow addon itself to include if needed.
---
 cmake/addons/CMakeLists.txt                                 | 3 ---
 cmake/addons/depends/common/kodi-platform/deps.txt          | 2 --
 cmake/addons/depends/common/kodi-platform/kodi-platform.txt | 1 -
 3 files changed, 6 deletions(-)
 delete mode 100644 cmake/addons/depends/common/kodi-platform/deps.txt
 delete mode 100644 cmake/addons/depends/common/kodi-platform/kodi-platform.txt

diff --git a/cmake/addons/CMakeLists.txt b/cmake/addons/CMakeLists.txt
index a2a962f87919..7b217b85bde3 100644
--- a/cmake/addons/CMakeLists.txt
+++ b/cmake/addons/CMakeLists.txt
@@ -389,9 +389,6 @@ foreach(addon ${addons})
                                    DEPENDERS build
                                    ALWAYS 1)
 
-          # add "kodi-platform" as a dependency to every addon
-          add_dependencies(${id} kodi-platform)
-
           set(${id}_DEPENDS_DIR ${SOURCE_DIR}/depends)
 
           if(EXISTS ${${id}_DEPENDS_DIR})
diff --git a/cmake/addons/depends/common/kodi-platform/deps.txt b/cmake/addons/depends/common/kodi-platform/deps.txt
deleted file mode 100644
index b9538152d337..000000000000
--- a/cmake/addons/depends/common/kodi-platform/deps.txt
+++ /dev/null
@@ -1,2 +0,0 @@
-tinyxml
-p8-platform
diff --git a/cmake/addons/depends/common/kodi-platform/kodi-platform.txt b/cmake/addons/depends/common/kodi-platform/kodi-platform.txt
deleted file mode 100644
index e5f33f31cfed..000000000000
--- a/cmake/addons/depends/common/kodi-platform/kodi-platform.txt
+++ /dev/null
@@ -1 +0,0 @@
-kodi-platform https://github.com/xbmc/kodi-platform 809c5e9d711e378561440a896fcb7dbcd009eb3d

From cf1ca09a284569b44af23188235d56991991848d Mon Sep 17 00:00:00 2001
From: Alwin Esch <alwin.esch@web.de>
Date: Sat, 1 Feb 2020 21:50:42 +0100
Subject: [PATCH 2/4] [cmake][addons] remove tinyxml from addon depends

Allow addon itself to add if needed.
---
 .../depends/common/tinyxml/CMakeLists.txt     | 22 -------------------
 .../depends/common/tinyxml/tinyxml.sha256     |  1 -
 .../addons/depends/common/tinyxml/tinyxml.txt |  1 -
 3 files changed, 24 deletions(-)
 delete mode 100644 cmake/addons/depends/common/tinyxml/CMakeLists.txt
 delete mode 100644 cmake/addons/depends/common/tinyxml/tinyxml.sha256
 delete mode 100644 cmake/addons/depends/common/tinyxml/tinyxml.txt

diff --git a/cmake/addons/depends/common/tinyxml/CMakeLists.txt b/cmake/addons/depends/common/tinyxml/CMakeLists.txt
deleted file mode 100644
index ec396eeb4064..000000000000
--- a/cmake/addons/depends/common/tinyxml/CMakeLists.txt
+++ /dev/null
@@ -1,22 +0,0 @@
-cmake_minimum_required(VERSION 3.1)
-project(tinyxml)
-
-set(SOURCES src/tinystr.cpp
-            src/tinyxml.cpp
-            src/tinyxmlerror.cpp
-            src/tinyxmlparser.cpp)
-
-if(WIN32)
-  add_definitions(-DWIN32 -D_LIB)
-endif()
-add_definitions(-DTIXML_USE_STL)
-
-add_library(tinyxml ${SOURCES})
-
-include_directories(${PROJECT_SOURCE_DIR}/include)
-
-set(HEADERS ${PROJECT_SOURCE_DIR}/include/tinystr.h
-            ${PROJECT_SOURCE_DIR}/include/tinyxml.h)
-
-install(FILES ${HEADERS} DESTINATION ${CMAKE_INSTALL_PREFIX}/include)
-install(TARGETS tinyxml DESTINATION ${CMAKE_INSTALL_PREFIX}/lib)
diff --git a/cmake/addons/depends/common/tinyxml/tinyxml.sha256 b/cmake/addons/depends/common/tinyxml/tinyxml.sha256
deleted file mode 100644
index 78c07c85acb9..000000000000
--- a/cmake/addons/depends/common/tinyxml/tinyxml.sha256
+++ /dev/null
@@ -1 +0,0 @@
-8164c9ad48b9028667768a584d62f7760cfbfb90d0dd6214ad174403058da10c
diff --git a/cmake/addons/depends/common/tinyxml/tinyxml.txt b/cmake/addons/depends/common/tinyxml/tinyxml.txt
deleted file mode 100644
index f8e05e875682..000000000000
--- a/cmake/addons/depends/common/tinyxml/tinyxml.txt
+++ /dev/null
@@ -1 +0,0 @@
-tinyxml http://mirrors.kodi.tv/build-deps/sources/tinyxml-2.6.2_2.tar.gz

From d14d3db099e9de8787a7d1fcb6c24eba421fe801 Mon Sep 17 00:00:00 2001
From: Alwin Esch <alwin.esch@web.de>
Date: Sat, 1 Feb 2020 21:52:20 +0100
Subject: [PATCH 3/4] [cmake][addons] remove p8-platform from addon depends

Allow addon itself to add if needed.
---
 cmake/addons/depends/common/p8-platform/p8-platform.txt       | 1 -
 cmake/addons/depends/windowsstore/p8-platform/p8-platform.txt | 1 -
 2 files changed, 2 deletions(-)
 delete mode 100644 cmake/addons/depends/common/p8-platform/p8-platform.txt
 delete mode 100644 cmake/addons/depends/windowsstore/p8-platform/p8-platform.txt

diff --git a/cmake/addons/depends/common/p8-platform/p8-platform.txt b/cmake/addons/depends/common/p8-platform/p8-platform.txt
deleted file mode 100644
index 98ed58a6be5d..000000000000
--- a/cmake/addons/depends/common/p8-platform/p8-platform.txt
+++ /dev/null
@@ -1 +0,0 @@
-p8-platform https://github.com/xbmc/platform.git cee64e9dc0b69e8d286dc170a78effaabfa09c44
diff --git a/cmake/addons/depends/windowsstore/p8-platform/p8-platform.txt b/cmake/addons/depends/windowsstore/p8-platform/p8-platform.txt
deleted file mode 100644
index db6f782502f1..000000000000
--- a/cmake/addons/depends/windowsstore/p8-platform/p8-platform.txt
+++ /dev/null
@@ -1 +0,0 @@
-p8-platform https://github.com/afedchin/platform.git win10

From bd6fa65129fb568f2296f26c4939856cb933014f Mon Sep 17 00:00:00 2001
From: Alwin Esch <alwin.esch@web.de>
Date: Sat, 1 Feb 2020 21:53:21 +0100
Subject: [PATCH 4/4] [cmake][addons] remove windowsstore path, there no
 differences anymore to windows path

---
 .../depends/windowsstore/CMakeLists.txt       | 52 -------------------
 .../addons/depends/windowsstore/Install.cmake | 24 ---------
 cmake/addons/depends/windowsstore/README      | 19 -------
 .../depends/windowsstore/prebuilt/README      | 21 --------
 4 files changed, 116 deletions(-)
 delete mode 100644 cmake/addons/depends/windowsstore/CMakeLists.txt
 delete mode 100644 cmake/addons/depends/windowsstore/Install.cmake
 delete mode 100644 cmake/addons/depends/windowsstore/README
 delete mode 100644 cmake/addons/depends/windowsstore/prebuilt/README

diff --git a/cmake/addons/depends/windowsstore/CMakeLists.txt b/cmake/addons/depends/windowsstore/CMakeLists.txt
deleted file mode 100644
index c8739c08eca1..000000000000
--- a/cmake/addons/depends/windowsstore/CMakeLists.txt
+++ /dev/null
@@ -1,52 +0,0 @@
-cmake_minimum_required(VERSION 3.1)
-project(kodi-addons-depends-windows)
-
-list(APPEND CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR})
-
-if(NOT CMAKE_BUILD_TYPE)
-  set(CMAKE_BUILD_TYPE Release)
-endif()
-
-include(ExternalProject)
-
-if(NOT ADDON_DEPENDS_PATH)
-  message(FATAL_ERROR "ADDON_DEPENDS_PATH (${ADDON_DEPENDS_PATH}) is not a valid target directory.")
-else()
-  file(TO_CMAKE_PATH "${ADDON_DEPENDS_PATH}" ADDON_DEPENDS_PATH)
-endif()
-get_filename_component(ADDON_DEPENDS_PATH "${ADDON_DEPENDS_PATH}" ABSOLUTE)
-list(APPEND CMAKE_PREFIX_PATH ${ADDON_DEPENDS_PATH})
-
-if(NOT DEPENDS_TO_BUILD)
-  set(DEPENDS_TO_BUILD "all")
-endif()
-
-function(add_internal id url inputfile)
-  externalproject_add(${id}
-                      URL ${url}
-                      PREFIX build/${id}
-                      CONFIGURE_COMMAND ""
-                      BUILD_COMMAND ""
-                      INSTALL_COMMAND ${CMAKE_COMMAND}
-                                      -DINPUTDIR=${PROJECT_BINARY_DIR}/build/${id}/src/${id}
-                                      -DINPUTFILE=${inputfile}
-                                      -DDESTDIR=${ADDON_DEPENDS_PATH}
-                                      -P ${PROJECT_SOURCE_DIR}/Install.cmake
-                     )
-endfunction()
-
-file(GLOB_RECURSE download_input_files prebuilt/*.txt)
-foreach(file ${download_input_files})
-  if(NOT file MATCHES install.txt)
-    file(STRINGS ${file} def)
-    get_filename_component(dir ${file} DIRECTORY)
-    string(REPLACE " " ";" def ${def})
-    list(GET def 0 id)
-
-    list(FIND DEPENDS_TO_BUILD ${id} idx)
-    if(idx GREATER -1 OR DEPENDS_TO_BUILD STREQUAL "all")
-      list(GET def 1 url)
-      add_internal(${id} ${url} ${dir}/install.txt)
-    endif()
-  endif()
-endforeach()
diff --git a/cmake/addons/depends/windowsstore/Install.cmake b/cmake/addons/depends/windowsstore/Install.cmake
deleted file mode 100644
index 9a3adbb7c381..000000000000
--- a/cmake/addons/depends/windowsstore/Install.cmake
+++ /dev/null
@@ -1,24 +0,0 @@
-if(EXISTS "${INPUTFILE}")
-  # if there's an input file we use it to determine which files to copy where
-  file(STRINGS ${INPUTFILE} FILES)
-  string(REPLACE "\n" ";" FILES "${FILES}")
-  foreach(file ${FILES})
-    string(REPLACE " " ";" file "${file}")
-    list(GET file 0 dir)
-    list(GET file 1 dest)
-    list(LENGTH file deflength)
-    if(deflength GREATER 2)
-      list(GET file 2 copy)
-    endif()
-    file(GLOB files ${INPUTDIR}/${dir})
-    foreach(instfile ${files})
-      file(COPY ${instfile} DESTINATION ${DESTDIR}/${dest})
-      if(copy)
-        file(COPY ${instfile} DESTINATION ${DESTDIR}/${copy})
-      endif()
-    endforeach()
-  endforeach()
-else()
-  # otherwise we assume that the content of the extracted archive is already well-formed and can just be copied
-  file(COPY ${INPUTDIR}/${dir} DESTINATION ${DESTDIR})
-endif()
\ No newline at end of file
diff --git a/cmake/addons/depends/windowsstore/README b/cmake/addons/depends/windowsstore/README
deleted file mode 100644
index 67dc59451d34..000000000000
--- a/cmake/addons/depends/windowsstore/README
+++ /dev/null
@@ -1,19 +0,0 @@
-KODI WIN32 ADDON DEPENDENCIES
-=============================
-This directory contains the cmake-based buildsystem for dependencies (currently
-only prebuilt) used by one or multiple addons. The buildsystem looks into the
-"prebuilt" sub-directory, downloads all the specified dependencies, extracts
-them and places them into the "depends" sub-directory.
-
-To trigger the cmake-based buildsystem the following command must be executed
-with <path> being the path to this directory (absolute or relative, allowing for
-in-source and out-of-source builds).
-
-  cmake <path> [-G <generator>]
-
-cmake supports multiple generators, see
-http://www.cmake.org/cmake/help/v2.8.8/cmake.html#section_Generators for a list.
-For win32 builds one of the "Visual Studio XX" or the "NMake Makefiles"
-generators is preferred. For the "NMake Makefiles" generator to work the above
-command must be called from an environment prepared for VC++ builds (see
-http://msdn.microsoft.com/en-us/library/f2ccy3wt.aspx).
diff --git a/cmake/addons/depends/windowsstore/prebuilt/README b/cmake/addons/depends/windowsstore/prebuilt/README
deleted file mode 100644
index a0c70d6bde6d..000000000000
--- a/cmake/addons/depends/windowsstore/prebuilt/README
+++ /dev/null
@@ -1,21 +0,0 @@
-KODI WIN32 PREBUILT ADDON DEPENDENCIES
-======================================
-This directory contains a file or sub-directory for every prebuilt dependency
-used by one of the addons being built. There are two different modes supported.
-Both include a file named <library-id>.txt which must follow the defined format
-  <library-id> <download-url>
-
-If the archive, which the <download-url> points at, contains
- * only the necessary files and in the proper directory structure (i.e. an
-   "include" and a "lib" directory) then the file must be put into this
-   directory and nothing else is needed.
- * unnecessary files and/or does not follow the defined directory structure
-   (i.e. an "include" and a "lib" directory) then the file must be put into a
-   sub-directory named <library-id>. Furthermore an additional file called
-   "install.txt" must be placed in that sub-directory. install.txt contains a
-   line for every path/directory/file with a destination where it must be copied
-   to. It must follow the defined format
-     <source> <destination> [<copy-destination>]
-   where <source> must be an existing file, directory or a path containing
-   wildcards, <destination> and the optional <copy-destination> must be existing
-   directories.
