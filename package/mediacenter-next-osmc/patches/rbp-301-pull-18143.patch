From 2269e071c6ae1f3a44300ff2d7122eaea76875a7 Mon Sep 17 00:00:00 2001
From: enen92 <92enen@gmail.com>
Date: Mon, 6 Jul 2020 14:05:43 +0100
Subject: [PATCH 1/2] Fix oppacity calculation if previous colour contains an
 alpha value (credits: paxxi)

---
 xbmc/utils/ColorUtils.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/xbmc/utils/ColorUtils.cpp b/xbmc/utils/ColorUtils.cpp
index 41a8c15d3ff1..80319a0b4482 100644
--- a/xbmc/utils/ColorUtils.cpp
+++ b/xbmc/utils/ColorUtils.cpp
@@ -15,5 +15,5 @@
 UTILS::Color ColorUtils::ChangeOpacity(const UTILS::Color color, const float opacity)
 {
   int newAlpha = ceil( ((color >> 24) & 0xff) * opacity);
-  return color + (newAlpha << 24);
+  return (color & 0x00FFFFFF) | (newAlpha << 24);
 };

From 80e46180c28d27dfc89e57a2b0d01e15efeafd66 Mon Sep 17 00:00:00 2001
From: enen92 <92enen@gmail.com>
Date: Mon, 6 Jul 2020 14:09:43 +0100
Subject: [PATCH 2/2] [DX] Enable alpha-blending for video renderer (credits:
 afedchin)

---
 xbmc/cores/VideoPlayer/VideoRenderers/WinRenderer.cpp | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/xbmc/cores/VideoPlayer/VideoRenderers/WinRenderer.cpp b/xbmc/cores/VideoPlayer/VideoRenderers/WinRenderer.cpp
index e48e2e4b3196..4e52d1cede32 100644
--- a/xbmc/cores/VideoPlayer/VideoRenderers/WinRenderer.cpp
+++ b/xbmc/cores/VideoPlayer/VideoRenderers/WinRenderer.cpp
@@ -210,8 +210,9 @@ void CWinRenderer::RenderUpdate(int index, int index2, bool clear, unsigned int
   DX::Windowing()->SetAlphaBlendEnable(alpha < 255);
 
   ManageRenderArea();
-  m_renderer->Render(index, index2, DX::Windowing()->GetBackBuffer(), 
-                     m_sourceRect, m_destRect, GetScreenRect(), flags);
+  m_renderer->Render(index, index2, DX::Windowing()->GetBackBuffer(), m_sourceRect, m_destRect,
+                     GetScreenRect(), flags);
+  DX::Windowing()->SetAlphaBlendEnable(true);
 }
 
 bool CWinRenderer::RenderCapture(CRenderCapture* capture)
