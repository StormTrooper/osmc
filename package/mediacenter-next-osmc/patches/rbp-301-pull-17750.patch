From 1b46f3413b1ea3ab96e6ddb895c185e29147305f Mon Sep 17 00:00:00 2001
From: enen92 <92enen@gmail.com>
Date: Sat, 25 Apr 2020 12:44:16 +0100
Subject: [PATCH] [python] Move xbmc.validatePath to xbmcvfs.validatePath

---
 .../doxygen/Modules/modules_python.dox        |  5 ++++
 xbmc/interfaces/legacy/ModuleXbmc.cpp         |  6 ----
 xbmc/interfaces/legacy/ModuleXbmc.h           | 28 -----------------
 xbmc/interfaces/legacy/ModuleXbmcvfs.cpp      |  7 +++++
 xbmc/interfaces/legacy/ModuleXbmcvfs.h        | 30 +++++++++++++++++++
 5 files changed, 42 insertions(+), 34 deletions(-)

diff --git a/xbmc/addons/kodi-addon-dev-kit/doxygen/Modules/modules_python.dox b/xbmc/addons/kodi-addon-dev-kit/doxygen/Modules/modules_python.dox
index 92eb0b5828c1..4f2e00b12d7f 100644
--- a/xbmc/addons/kodi-addon-dev-kit/doxygen/Modules/modules_python.dox
+++ b/xbmc/addons/kodi-addon-dev-kit/doxygen/Modules/modules_python.dox
@@ -218,6 +218,11 @@ web applications or frameworks for the Python programming language.
       "",
       <b>xbmc.makeLegalFilename()</b> function was moved to the xbmcvfs module.
 }
+\python_removed_function{
+      validatePath,
+      "",
+      <b>xbmc.validatePath()</b> function was moved to the xbmcvfs module.
+}
 */
 /*!
 @page python_v18 Python API v18
diff --git a/xbmc/interfaces/legacy/ModuleXbmc.cpp b/xbmc/interfaces/legacy/ModuleXbmc.cpp
index a3be0422e830..d621f133c61a 100644
--- a/xbmc/interfaces/legacy/ModuleXbmc.cpp
+++ b/xbmc/interfaces/legacy/ModuleXbmc.cpp
@@ -396,12 +396,6 @@ namespace XBMCAddon
       return Tuple<String,String>(strTitle,strYear);
     }
 
-    String validatePath(const String& path)
-    {
-      XBMC_TRACE;
-      return CUtil::ValidatePath(path, true);
-    }
-
     String getRegion(const char* id)
     {
       XBMC_TRACE;
diff --git a/xbmc/interfaces/legacy/ModuleXbmc.h b/xbmc/interfaces/legacy/ModuleXbmc.h
index 0eee15ca06ab..260fa5bdccdc 100644
--- a/xbmc/interfaces/legacy/ModuleXbmc.h
+++ b/xbmc/interfaces/legacy/ModuleXbmc.h
@@ -690,34 +690,6 @@ namespace XBMCAddon
     Tuple<String,String> getCleanMovieTitle(const String& path, bool usefoldername = false);
 #endif
 
-#ifdef DOXYGEN_SHOULD_USE_THIS
-    ///
-    /// \ingroup python_xbmc
-    /// @brief \python_func{ xbmc.validatePath(path) }
-    ///-----------------------------------------------------------------------
-    /// Returns the validated path.
-    ///
-    /// @param path                  string or unicode - Path to format
-    /// @return                      Validated path
-    ///
-    /// @note Only useful if you are coding for both Linux and Windows for fixing slash problems.
-    ///       e.g. Corrects 'Z://something' -> 'Z:\something'
-    ///
-    ///
-    /// ------------------------------------------------------------------------
-    ///
-    /// **Example:**
-    /// ~~~~~~~~~~~~~{.py}
-    /// ..
-    /// fpath = xbmc.validatePath(somepath)
-    /// ..
-    /// ~~~~~~~~~~~~~
-    ///
-    validatePath(...);
-#else
-    String validatePath(const String& path);
-#endif
-
 #ifdef DOXYGEN_SHOULD_USE_THIS
     ///
     /// \ingroup python_xbmc
diff --git a/xbmc/interfaces/legacy/ModuleXbmcvfs.cpp b/xbmc/interfaces/legacy/ModuleXbmcvfs.cpp
index 120a5de28d72..495f9bd425b2 100644
--- a/xbmc/interfaces/legacy/ModuleXbmcvfs.cpp
+++ b/xbmc/interfaces/legacy/ModuleXbmcvfs.cpp
@@ -57,6 +57,13 @@ namespace XBMCAddon
       return CUtil::MakeLegalPath(filename);
     }
 
+    // validate path
+    String validatePath(const String& path)
+    {
+      XBMC_TRACE;
+      return CUtil::ValidatePath(path, true);
+    }
+
     // make a directory
     bool mkdir(const String& path)
     {
diff --git a/xbmc/interfaces/legacy/ModuleXbmcvfs.h b/xbmc/interfaces/legacy/ModuleXbmcvfs.h
index 949807bc007b..556acddccb6e 100644
--- a/xbmc/interfaces/legacy/ModuleXbmcvfs.h
+++ b/xbmc/interfaces/legacy/ModuleXbmcvfs.h
@@ -172,6 +172,36 @@ namespace XBMCAddon
     String makeLegalFilename(const String& filename);
 #endif
 
+#ifdef DOXYGEN_SHOULD_USE_THIS
+    ///
+    /// \ingroup python_xbmcvfs
+    /// @brief \python_func{ xbmcvfs.validatePath(path) }
+    ///-----------------------------------------------------------------------
+    /// Returns the validated path.
+    ///
+    /// @param path                  string  - Path to format
+    /// @return            Validated path
+    ///
+    /// @note The result is platform-specific. Only useful if you are coding
+    ///       for multiple platfforms for fixing slash problems
+    ///         (e.g. Corrects 'Z://something' -> 'Z:\something').
+    ///
+    ///
+    /// ------------------------------------------------------------------------
+    /// @python_v19 New function added (replaces old **xbmc.validatePath**)
+    ///
+    /// **Example:**
+    /// ~~~~~~~~~~~~~{.py}
+    /// ..
+    /// fpath = xbmcvfs.validatePath(somepath)
+    /// ..
+    /// ~~~~~~~~~~~~~
+    ///
+    validatePath(...);
+#else
+    String validatePath(const String& path);
+#endif
+
 #ifdef DOXYGEN_SHOULD_USE_THIS
     ///
     /// \ingroup python_xbmcvfs
